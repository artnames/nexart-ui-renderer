SoundArt ‚Üí Code Mode Integration

Context

NexArt currently has:
	‚Ä¢	A Code Mode engine (the canonical, deterministic generative runtime)
	‚Ä¢	A SoundArt engine built on Canvas2D with its own style system

The goal is to merge SoundArt into the Code Mode engine, so SoundArt becomes an input layer, not a parallel renderer.

Code Mode must remain the single protocol execution layer.

‚∏ª

üéØ Objective

Refactor SoundArt so that:
	1.	Sound analysis produces a canonical snapshot
	2.	That snapshot is injected into Code Mode as deterministic inputs
	3.	SoundArt styles become ordinary Code Mode sketches
	4.	No SoundArt-specific rendering engine remains

‚∏ª

üß† Target Architecture (IMPORTANT)

1Ô∏è‚É£ Sound ‚Üí Snapshot (keep Canvas2D here if needed)
Sound analysis may stay Canvas2D / WebAudio-based, but it must output only data, not visuals.

Canonical snapshot shape (example):

SoundSnapshot = {
  volume: number        // 0‚Äì100
  brightness: number
  aggression: number
  harmonicity: number
  rhythmicity: number
  bass: number
  mid: number
  treble: number
  attack: number
  dynamicRange: number
  length: number
  hue: number
  chroma: number
  t: number             // time or frame
}

This snapshot must be:
	‚Ä¢	Pure data
	‚Ä¢	Deterministic for a given audio input + frame
	‚Ä¢	Serializable

‚∏ª

2Ô∏è‚É£ Inject snapshot into Code Mode
Expose the snapshot inside Code Mode as a read-only global object:

S.volume
S.bass
S.treble
S.t

Rules:
	‚Ä¢	No randomness introduced here
	‚Ä¢	Snapshot is frozen per render/frame
	‚Ä¢	Code Mode remains deterministic

‚∏ª

3Ô∏è‚É£ Refactor SoundArt styles
Each SoundArt style must be converted to:
	‚Ä¢	A pure Code Mode sketch
	‚Ä¢	Using S.* instead of SoundArt helpers
	‚Ä¢	Using existing Code Mode primitives (point, line, geometry guides, etc.)

Example conversion:

const density = map(S.volume, 0, 100, 200, 2000)
const chaos = S.aggression * 0.01
const hue = S.hue * 3.6

No Canvas2D calls inside styles.

‚∏ª

üö´ Explicitly Do NOT
	‚Ä¢	Do NOT create a second rendering engine
	‚Ä¢	Do NOT keep SoundArt-only APIs
	‚Ä¢	Do NOT mix protocol logic with audio analysis
	‚Ä¢	Do NOT break existing Code Mode determinism

‚∏ª

‚úÖ Success Criteria

By the end of this task:
	‚Ä¢	SoundArt is implemented as Code Mode + sound inputs
	‚Ä¢	Adding a new SoundArt style requires only a Code Mode sketch
	‚Ä¢	Code Mode remains the single NexArt protocol runtime
	‚Ä¢	Canvas2D is used only for:
	‚Ä¢	audio analysis
	‚Ä¢	preview rendering (if needed)

‚∏ª

üì¶ Deliverables
	1.	SoundSnapshot type definition
	2.	Snapshot ‚Üí Code Mode injection layer
	3.	Example converted SoundArt style written as Code Mode
	4.	Clear separation between:
	‚Ä¢	sound analysis
	‚Ä¢	protocol execution
	‚Ä¢	rendering

‚∏ª

üß≠ Guiding Principle

If a feature cannot be expressed as a Code Mode sketch using S.* inputs, it does not belong in SoundArt.

‚∏ª
