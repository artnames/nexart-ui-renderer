Implement NexArt UI Renderer SDK v0.3 (Code Mode support)

Context

You are working on the npm package @nexart/ui-renderer.
This SDK already supports declarative generative systems (dots, lines, flow, etc.).

NexArt now requires Code Mode support in the SDK, using the exact same runtime and determinism guarantees as nexart.xyz.

This is a protocol-level change. Do not invent new renderers or abstractions.

‚∏ª

üéØ Goal

Extend @nexart/ui-renderer to support Code Mode systems, so external builders (Replit, Lovable, Cursor) can render canonical NexArt Code Mode sketches.

The SDK must:
	‚Ä¢	Execute raw Code Mode sketches
	‚Ä¢	Use the same Code Mode runtime as nexart.xyz
	‚Ä¢	Preserve determinism, seeding, and loop behavior
	‚Ä¢	Integrate cleanly into createSystem() and previewSystem()
	‚Ä¢	Introduce no parallel rendering engine

‚∏ª

üß† Critical Constraints (DO NOT VIOLATE)

‚ùå Do NOT:
	‚Ä¢	Create a new sketch renderer
	‚Ä¢	Create a SketchElement, PreviewRenderer, or custom lifecycle
	‚Ä¢	Re-implement p5 / randomness / noise
	‚Ä¢	Execute sketches outside the Code Mode runtime
	‚Ä¢	Add silent fallbacks

‚úÖ ONLY:
	‚Ä¢	Reuse the existing NexArt Code Mode runtime
	‚Ä¢	Extend the canonical system schema
	‚Ä¢	Route rendering through the same execution path as nexart.xyz

‚∏ª

üß© Canonical System Shape (MUST MATCH)

Add support for this system type:

type CodeSystem = {
  type: "code";
  source: string;              // verbatim sketch code
  mode: "static" | "loop";
  width: number;
  height: number;
  seed?: number;
  totalFrames?: number;        // required if mode === "loop"
};

No other fields.
No wrappers.
No interpretation.

‚∏ª

üîß Implementation Tasks

1Ô∏è‚É£ Extend system types
	‚Ä¢	Update types to include CodeSystem
	‚Ä¢	Update validation to enforce:
	‚Ä¢	source is required
	‚Ä¢	mode === "loop" requires totalFrames

‚∏ª

2Ô∏è‚É£ Integrate Code Mode runtime
	‚Ä¢	Import the existing Code Mode runtime used by nexart.xyz
	‚Ä¢	Reuse:
	‚Ä¢	seeded RNG
	‚Ä¢	seeded noise
	‚Ä¢	p5-runtime
	‚Ä¢	loop/static execution logic
	‚Ä¢	Do not modify runtime behavior

‚∏ª

3Ô∏è‚É£ Extend createSystem()
	‚Ä¢	Accept { type: "code", ... }
	‚Ä¢	Validate but do not transform the sketch
	‚Ä¢	Store source verbatim

‚∏ª

4Ô∏è‚É£ Extend previewSystem()
	‚Ä¢	Detect system.type === "code"
	‚Ä¢	Route to renderCodeModeSystem(system, canvas)
	‚Ä¢	This function must:
	‚Ä¢	Create Code Mode runtime
	‚Ä¢	Inject the sketch verbatim
	‚Ä¢	Apply seed deterministically
	‚Ä¢	Run in static or loop mode
	‚Ä¢	No try/catch fallbacks
	‚Ä¢	Errors must surface

‚∏ª

5Ô∏è‚É£ Acceptance Test (MANDATORY)
Verify that this works unchanged:

const system = createSystem({
  type: "code",
  mode: "loop",
  width: 1950,
  height: 2400,
  totalFrames: 120,
  source: `
    function setup() { noFill(); }
    function draw() { background(246,245,242); }
  `
});

previewSystem(system, canvas);

The output must match nexart.xyz Code Mode behavior.

‚∏ª

üì¶ Versioning
	‚Ä¢	Bump version to v0.3.0
	‚Ä¢	Update package exports if needed
	‚Ä¢	Update README with one Code Mode example
	‚Ä¢	Do not remove existing primitives

‚∏ª

üìú Definition of Done

‚úÖ SDK renders Code Mode sketches
‚úÖ Deterministic output
‚úÖ No legacy or parallel renderer
‚úÖ One unified runtime
‚úÖ Ready for npm publish

‚∏ª

Start with types + runtime integration first.
Do not move on until Code Mode rendering is pixel-correct.

